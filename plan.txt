# UMHC Finance Hub - Refactored Implementation

## Overview
A web application that allows users to upload financial data from Excel files (.xlsx) to a Google Sheet, with robust duplicate detection and timezone-safe date handling. The application has been refactored to be modular and expandable.

## Core Features

### Client-Side (JavaScript)
- **Modular Architecture:** The JavaScript code is divided into modules for UI, API, Excel parsing, and data handling.
- **Tag Management:** Users can view, add, and assign 'Trip/Event' and 'Category' tags to expenses. New tags are available for use immediately. Users can also delete tags, which removes them from the list of available tags and from all expenses that have them.
- **Authentication:** Secure login system using API key stored in Google Sheet.
- **Excel Processing:** Client-side Excel file parsing using `read-excel-file` library.
- **Google Sheets Integration:** Uploads data to 'Finances' Google Sheet.
- **Duplicate Detection:** Client-side duplicate checking to avoid uploading existing records.
- **Data Processing:** Chunked upload system for large datasets.
- **Date Handling:** String-only date processing to prevent timezone conversion issues.
- **User Interface:** Simple login, file upload, and data preview functionality.

### Server-Side (Google Apps Script)
- **Modular Architecture:** The Google Apps Script code is organized into separate files for the main entry point, configuration, sheet interaction, and authentication.
- **Tag Deletion:** Provides an endpoint to delete a tag from the 'Tags' sheet and remove it from all expenses in the 'Finances' sheet.
- **Automatic Sorting:** The Google Sheet is automatically sorted by date (most recent first) after every data upload, while carefully handling date and timezone conversions.
- **Robustness:** The script now automatically creates the 'Finances' and 'Tags' sheets if they don't exist, preventing errors.
- **Data Integrity:** Prevents duplicate tags from being added and ensures tags are stored in their respective columns without creating blank rows.
- **API Endpoints:** Provides endpoints for login, saving data, and retrieving data.
- **Batch Operations:** Uses batch operations for efficient Google Sheets updates.
- **Robust Error Handling:** Includes error handling for all major operations.
- **JSONP Communication:** Uses JSONP for communication with the client-side application.

### User Interface Improvements
- **Fixed Container Approach:** Implemented a fixed container for the login screen to prevent layout shifts when loading/success/error messages appear.
- **Visual Integration:** The login container now blends seamlessly with the background, removing visible borders and shadows.
- **Consistent Layout:** Status messages appear in a fixed-height container to maintain consistent UI position regardless of message content.
- **Professional Styling:** Enhanced visual design with improved spacing, typography, and responsive behavior.
